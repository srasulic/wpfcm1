<UserControl x:Class="wpfcm1.FolderGroups.FolderGroupView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             xmlns:cal="http://www.caliburnproject.org">
    <Grid>
        <Grid.Resources>
            <BooleanToVisibilityConverter x:Key="b2vc" />
        </Grid.Resources>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" Name="FolderColumn"/>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" Name="PreviewColumn" />
        </Grid.ColumnDefinitions>

        <TabControl x:Name="FolderVMs" IsSynchronizedWithCurrentItem="True" mah:TabControlHelper.Underlined="TabItems"
                    cal:Message.Attach="[Event SelectionChanged] = [Action ActivateTabItem($eventArgs)]">
            <TabControl.ItemTemplate>
                <DataTemplate>
                    <TextBlock>
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0} ({1:D})">
                                <Binding Path="DisplayName"/>
                                <Binding Path="Documents.Count"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </DataTemplate>
            </TabControl.ItemTemplate>
        </TabControl>
        
        <GridSplitter Grid.Row="0" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Stretch" Width="6" Margin="0,11,0,0"/>
        <ContentControl Grid.Row="0" Grid.Column="2" x:Name="Preview" Margin="0,11,0,0" 
                        Visibility="{Binding Path=Preview.PreviewVisibility, Converter={StaticResource b2vc}}"
                        IsVisibleChanged="Preview_OnIsVisibleChanged" />
    </Grid>
</UserControl>
